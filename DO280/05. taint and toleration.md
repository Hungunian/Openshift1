## Prepare the lab for this question 1?
```
oc adm taint node $(oc get nodes | awk '{print $1}' | grep -v NAME) datacenter=delhi:NoSchedule
oc new-project chapter1
oc new-app --name webserver-app1 --image registry.ocp4.example.com:8443/redhattraining/hello-world-nginx:v1.0 
```


# Question 1. An application is running on the `chapter1` project. There is one pod running and your task is it must generate the output.

```
oc project chapter1
```
### Pre-Check, you must observe that pod is in the pending state.
```
oc get all
```
### Identify the nodes on which having issue.
```
oc get pods -o wide
```
### Check the events. 
```
oc env
```

```
3m14s                 Normal    ScalingReplicaSet   Deployment/webserver-app1              Scaled up replica set webserver-app1-c8995748c to 1
3m14s                 Normal    ScalingReplicaSet   Deployment/webserver-app1              Scaled up replica set webserver-app1-6bc4fdd7b6 to 1
3m14s                 Normal    SuccessfulCreate    ReplicaSet/webserver-app1-c8995748c    Created pod: webserver-app1-c8995748c-4cg5l
3m14s                 Warning   FailedScheduling    Pod/webserver-app1-c8995748c-4cg5l     0/1 nodes are available: 1 node(s) had untolerated taint {datacenter: delhi}. preemption: 0/1 nodes are available: 1 Preemption is not helpful for scheduling..
3m13s                 Warning   FailedCreate        ReplicaSet/webserver-app1-6bc4fdd7b6   Error creating: Pod "webserver-app1-6bc4fdd7b6-6kzn4" is invalid: spec.containers[0].image: Invalid value: " ": must not have leading or trailing whitespace
30s (x7 over 3m12s)   Warning   FailedCreate        ReplicaSet/webserver-app1-6bc4fdd7b6   (combined from similar events): Error creating: Pod "webserver-app1-6bc4fdd7b6-wvwzj" is invalid: spec.containers[0].image: Invalid value: " ": must not have leading or trailing whitespace


```
### If you observe the `untolerated taint` errror message, it means that taint is applied on nodes and you have to add the toleration on pod or remove the taint from the node.
```
oc describe node master01 | grep -i taint
```

## How to remove the taint from nodes? Please note that, if you have multiple nodes then you have to remove the taint from all the workernodes. 
```
oc adm taint node master01 datacenter-
```
### Post check.
```
oc get pods
```

#### See the below output only for your references.
```
[student@workstation ~]$ oc get pods
NAME                             READY   STATUS    RESTARTS   AGE
webserver-app1-c8995748c-4cg5l   0/1     Pending   0          6m44s
[student@workstation ~]$ oc describe node master01 | grep -i taint
Taints:             datacenter=delhi:NoSchedule
[student@workstation ~]$ oc adm taint node master01 datacenter-
node/master01 untainted
[student@workstation ~]$ oc describe node master01 | grep -i taint
Taints:             <none>
[student@workstation ~]$ oc get pods
NAME                             READY   STATUS    RESTARTS   AGE
webserver-app1-c8995748c-4cg5l   1/1     Running   0          9m48s

[student@workstation ~]$
```

### Check the service is created or not ?
```
oc get service
```

## If it is not created then create a new one.
```
oc expose service webserver-app1
```
### How to check ?
```
oc get svc,route
```
### Open the webiste. Either CLI or webportal.
```
curl ebserver-app1-chapter1.apps.ocp4.example.com  | head
```
---
## Prepare the lab for this question 2?
```
oc new-project chapter2
oc new-app --name webserver-app2 --image registry.ocp4.example.com:8443/redhattraining/hello-world-nginx:v1.0
oc expose service webserver-app2 
oc patch service webserver-app2 -n chapter2 --type=json -p='[{"op": "replace", "path": "/spec/selector/deployment", "value": "anishrana2001"}]'
```


# Question 2. An application is running on the `chapter2` project. There is one pod running and your task is it must generate the output.
---
### Solution
### Check the resources.
```
oc get all
```

### You may observe that pods is running. So, check the logs and event
```
oc logs pods/pod_name
```
```
oc events
```
### You may not observe any thing. So let's open the URL
```
oc get route
```
### For my lab, it is : webserver-app2-chapter2.apps.ocp4.example.com
```
http://webserver-app2-chapter2.apps.ocp4.example.com
```

### It should not work. It means that application inside the pod is working fine but we are not able to reach to pod.
### Check service.
```
oc describe service webserver-app2
```

````
[student@workstation ~]$ oc describe service webserver-app2 
Name:              webserver-app2
Namespace:         chapter2
Labels:            app=webserver-app2
                   app.kubernetes.io/component=webserver-app2
                   app.kubernetes.io/instance=webserver-app2
Annotations:       openshift.io/generated-by: OpenShiftNewApp
Selector:          deployment=anishrana2001      ### Check the label
Type:              ClusterIP
IP Family Policy:  SingleStack
IP Families:       IPv4
IP:                172.30.127.45
IPs:               172.30.127.45
Port:              8080-tcp  8080/TCP
TargetPort:        8080/TCP
Endpoints:         <none>      ### End points are empty.
Session Affinity:  None
Events:            <none>
```
### One can notice that endpoints are missing. You need to update the label on service. Thus, check the Deployment's yaml file and look for `template.metadata.label`
### Deployment is working so we will not going to change the label of Deployment and service is not working, so we will modify the service label.
```
oc get deployment/deployment_name -o yaml 
```
### For your references.
```
  template:
    metadata:
      annotations:
        openshift.io/generated-by: OpenShiftNewApp
      creationTimestamp: null
      labels:
        deployment: webserver-app2   >>>>
    spec:
      containers:
      - image: registry.ocp4.example.com:8443/redhattraining/hello-world-nginx@sha256:6926d361b8e2f778f88341fbd0d231337c38d12c177fdacf2a677dc6b70a1f59
        imagePullPolicy: IfNotPresent
```

```
oc edit service/todo-svc
```

### See the reference image.


### check the service again.
```
oc describe service webserver-app2
```

### You may not observe any thing. So let's open the URL
```
oc get route
```
### For my lab, it is : webserver-app2-chapter2.apps.ocp4.example.com
```
http://webserver-app2-chapter2.apps.ocp4.example.com
```







